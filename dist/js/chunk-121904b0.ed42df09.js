(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-121904b0"],{"0df4":function(t,e,n){"use strict";var a=n("0fe2"),o=n.n(a);o.a},"0fe2":function(t,e,n){},"4dc3":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mui-content"},[n("div",{staticClass:"mui-input-group"},[n("div",{staticClass:"mui-input-row"},[n("label",[t._v("场地名称:")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.areaInfo.name,expression:"areaInfo.name"}],attrs:{type:"text",placeholder:"扫描获取数据",readonly:"readonly"},domProps:{value:t.areaInfo.name},on:{input:function(e){e.target.composing||t.$set(t.areaInfo,"name",e.target.value)}}})]),n("div",{directives:[{name:"show",rawName:"v-show",value:t.checkContent.length>0,expression:"checkContent.length>0"}],staticClass:"mui-input-row ",staticStyle:{"text-align":"center","margin-top":".9rem"}},[n("span",{staticStyle:{"font-weight":"bold","font-size":"1em"},attrs:{id:"check_title"}},[t._v("检查项")])]),n("table",{staticClass:"tabLayout"},t._l(t.checkContent,function(e,a){return n("tr",[n("td",{staticStyle:{margin:"auto","font-size":"17px"},attrs:{width:"70%"}},[t._v(t._s(a+1)+"."+t._s(e.checkcontent))]),n("td",[n("select",{directives:[{name:"model",rawName:"v-model",value:e.selectVal,expression:"value.selectVal"}],staticStyle:{margin:"auto","font-size":"17px","text-align":"center"},attrs:{width:"30%"},on:{change:function(n){var a=Array.prototype.filter.call(n.target.options,function(t){return t.selected}).map(function(t){var e="_value"in t?t._value:t.value;return e});t.$set(e,"selectVal",n.target.multiple?a:a[0])}}},[n("option",{attrs:{value:"0"}},[t._v("达标")]),n("option",{domProps:{value:e.pk_checkcontent}},[t._v("不达标")])])])])}),0),n("textarea",{directives:[{name:"model",rawName:"v-model",value:t.remark,expression:"remark"},{name:"show",rawName:"v-show",value:t.checkContent.length>0,expression:"checkContent.length>0"}],staticStyle:{border:"none"},attrs:{rows:"5",placeholder:"备注："},domProps:{value:t.remark},on:{input:function(e){e.target.composing||(t.remark=e.target.value)}}})]),n("moon-loading",{directives:[{name:"show",rawName:"v-show",value:t.showLoading,expression:"showLoading"}],attrs:{"position-el":"body"}}),n("moon-dropdown",{model:{value:t.dropShow,callback:function(e){t.dropShow=e},expression:"dropShow"}},[n("ul",{staticClass:"moon-dropdown-ul"},t._l(t.menulist,function(e,a){return n("li",{key:a,on:{click:function(e){t.menuSelected(a)}}},[n("moon-icon",{attrs:{name:"moon-icon-fangdajing"}}),t._v("\n\t\t\t\t"+t._s(e)+"\n\t\t\t")],1)}),0)]),n("footer",{directives:[{name:"show",rawName:"v-show",value:t.checkContent.length>0,expression:"checkContent.length>0"}],staticClass:"mui-bar mui-bar-footer"},[n("button",{staticClass:"mui-btn mui-btn-block mui-btn-blue",on:{click:t.submitData}},[t._v("提交")])])],1)},o=[],r=(n("c764"),n("badb")),s=n.n(r);n("0a16"),n("ac74"),n("71d7");function c(t,e){for(var n in e){var a=new RegExp("(\\[)"+n+"(\\])","g");t=t.replace(a,e[n])}return t}var i={scanData:function(t){var e="where dr=0  and  pk_area='[pk]' order by ts desc",n={where:{pk:t}};return e=c(e,n.where),{select:"*",from:"{ad_area}",where:e}},contentData:function(t){var e="where dr=0  and  pk_area='[pk]' order by ts desc",n={where:{pk:t}};return e=c(e,n.where),{select:"*",from:"{ad_area_checkcontents}",where:e}},submitData:function(t){return{tableName:"ad_area_report",insertJson:s()(t)}}},u={scan:"/json/dinguser_getData",submit:"/json/dinguser_insertJson",getLastestData:""},l={Url:u},h=JSON.parse(s()(l).replace(/\s/g,"")),d={name:"AreaCheck",activated:function(){this.pk_ckuser=this.$store.state.home.userInfo.pk_psnbasdoc,this.pk_ckdept=this.$store.state.home.userInfo.pk_deptdoc,this.preMounted()},data:function(){return{pk_ckuser:"",pk_ckdept:"",showLoading:!1,menulist:["查询最近一次记录"],dropShow:!1,checkContent:[],remark:"",areaInfo:{}}},beforeRouteLeave:function(t,e,n){"home"===t.name&&this.reset(),n()},computed:{path:function(){return this.comMethods.projectPath()}},methods:{preMounted:function(){var t=this;dd.biz.navigation.setTitle({title:t.$route.meta.title,onSuccess:function(t){},onFail:function(t){log.e(s()(t))}}),dd.biz.navigation.setMenu({backgroundColor:"#ADD8E6",textColor:"#ADD8E611",items:[{id:"0",iconId:"scan",text:"扫描"}],onSuccess:function(e){switch(e.id){case"0":t.dropShow=!1,t.scan();break;case"1":t.dropShow=!t.dropShow;break;default:break}},onFail:function(t){}})},menuSelected:function(t){switch(this.dropShow=!1,t){case 0:this.query();break;default:break}},scan:function(){var t=this;this.reset(),dd.biz.util.scan({type:"all",onSuccess:function(e){var n=e.text,a=t.path+h.Url.scan;t.showLoading=!0;var o=i.scanData(n);t.$ajax.get(a,{params:o}).then(function(e){var n=e.data;n.success?(t.areaInfo=n.obj[0],t.timedCount_getCheckContent()):mui.alert(n.msg,"提示")}).catch(function(t){alert(t)}).then(function(){t.showLoading=!1})},onFail:function(t){}})},getCheckContent:function(){var t=this;t.showLoading=!0;var e=t.path+h.Url.scan,n=i.contentData(t.areaInfo.pk_area);t.$ajax.get(e,{params:n}).then(function(e){var n=e.data;n.success?(t.checkContent=n.obj,t.checkContent.forEach(function(t,e){t.selectVal=0})):mui.alert(n.msg,"提示")}).catch(function(t){alert(t)}).then(function(){t.showLoading=!1})},timedCount_getCheckContent:function(){var t=setTimeout(this.timedCount_getCheckContent,200);this.showLoading||(clearTimeout(t),this.getCheckContent())},reset:function(){this.checkContent.splice(0),this.remark="",this.areaInfo={}},submitData:function(){this.checkContent=JSON.parse(s()(this.checkContent)),this.showLoading=!0;var t=this.path+h.Url.submit,e=this,n={pk_area:e.areaInfo.pk_area,pk_checkcontent:[],ts:e.comMethods.formatDate(1),operator:e.pk_ckuser,remark:this.remark};this.checkContent.forEach(function(t,e){0!=t.selectVal&&n.pk_checkcontent.push(t.pk_checkcontent)});var a=i.submitData(n);this.$ajax.post(t,a).then(function(t){var n=t.data;n.success?(mui.alert("提交成功！"),e.reset()):mui.alert(n.msg,"提示")}).catch(function(t){alert(t)}).then(function(){e.showLoading=!1})},query:function(){}}},m=d,p=m,f=(n("0df4"),n("0c46")),k=Object(f["a"])(p,a,o,!1,null,"3d0969f4",null);e["default"]=k.exports}}]);